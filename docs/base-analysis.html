<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.13.3">
<title>Current Base Analysis | Lifeflight Dashboard</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,near-midnight.dcdbf18e.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,near-midnight.dcdbf18e.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="modulepreload" href="./_observablehq/client.33da7c34.js">
<link rel="modulepreload" href="./_observablehq/runtime.e080113b.js">
<link rel="modulepreload" href="./_observablehq/stdlib.73a8ec5a.js">
<link rel="modulepreload" href="./_import/components/scenario-modeling/heatmapOnly.b501aadd.js">
<link rel="modulepreload" href="./_import/components/scenario-modeling/responseTimeChart.d77f6cc8.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/72f4716c.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.4ef1d259.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.17/d761ef9b.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/18cbf477.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/e780feca.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/53fe8176.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/e93ca09f.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/0f2de24d.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/65eb105b.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/7ef8fb2e.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/aeb57b94.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/1d2aed74.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/5ced1d52.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/9ba9c7f3.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/4202580c.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/9cffc2bd.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/cdd7e898.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/b4e2ad9a.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/5e804d15.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/86074ef6.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/40599fb3.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/e49e792c.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/8d1e5425.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/20d3f133.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/7553081f.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/0dfd751c.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/3c90ee06.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/843b6a76.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/ba24c2e7.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/4d94e5b7.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/6d3a6726.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/9f03c579.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/07c9626f.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/b58a267d.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/004da2ac.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/b5786b3f.js">
<link rel="modulepreload" href="./_npm/binary-search-bounds@2.0.5/cbf6ba23.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/e08981d9.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/02d43215.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/aa00730b.js">
<link rel="icon" href="./_file/observable.1af93621.png" type="image/png" sizes="32x32">
<script type="module">

import {define} from "./_observablehq/client.33da7c34.js";

define({id: "e9491cd9", inputs: ["Inputs"], outputs: ["dataSet","basePlaceRoux","basePlaceMaster"], body: (Inputs) => {
const dataSet = Inputs.radio(["Roux Full Dispatch Data-redacted-v2.csv(2012-2023)", "FlightTransportsMaster.csv(2021-2024)"], {label: "Select a DataSet",value:"Roux Full Dispatch Data-redacted-v2.csv(2012-2023)"})
const basePlaceRoux = Inputs.checkbox(['ALL','LF1','LF2','LF3','LF4'], {label: "Select Unit Type",value:['ALL']});
const basePlaceMaster = Inputs.checkbox(['ALL','LF3', 'neoGround', 'LF1', 'L-CCT', 'LF2', 'LF4', 'B-CCT','S-CCT'], {label:"Select Unit Type",value:['ALL']})
return {dataSet,basePlaceRoux,basePlaceMaster};
}});

define({id: "c81f12a3", inputs: ["dataSet","display"], body: async (dataSet,display) => {
display(await(
dataSet
))
}});

define({id: "2f32ee86", inputs: ["Generators","dataSet"], outputs: ["dateSetFile"], body: (Generators,dataSet) => {
const dateSetFile = Generators.input(dataSet)
return {dateSetFile};
}});

define({id: "cfa06570", inputs: ["dateSetFile","display","basePlaceRoux","Generators","basePlaceMaster"], outputs: ["selectPlaceValue"], body: (dateSetFile,display,basePlaceRoux,Generators,basePlaceMaster) => {
let selectPlaceValue = null
if(dateSetFile=='Roux Full Dispatch Data-redacted-v2.csv(2012-2023)'){
  display(basePlaceRoux)
  selectPlaceValue = Generators.input(basePlaceRoux)
}else{
  display(basePlaceMaster)
  selectPlaceValue = Generators.input(basePlaceMaster)
}
return {selectPlaceValue};
}});

define({id: "542cb9ec", outputs: ["heatmapOnly"], body: async () => {
const {heatmapOnly} = await import("./_import/components/scenario-modeling/heatmapOnly.b501aadd.js");

return {heatmapOnly};
}});

define({id: "391f33ff", inputs: ["selectPlaceValue","URLSearchParams","dateSetFile"], outputs: ["mapData","mapError"], body: async (selectPlaceValue,URLSearchParams,dateSetFile) => {
let mapData = null
let mapError = null

if(selectPlaceValue && selectPlaceValue.length > 0){
  try{
    let basePlacesParam = selectPlaceValue.includes('ALL') 
      ? 'ALL' 
      : selectPlaceValue.join(',')
    
    const params = new URLSearchParams({
      dataset: dateSetFile,
      base_places: basePlacesParam
    })
    
    const mapResponse = await fetch(`http://localhost:5001/api/heatmap_by_base?${params}`)
    if(!mapResponse.ok){
      throw new Error(`HTTP ${mapResponse.status}: ${mapResponse.statusText}`)
    }
    const responseData = await mapResponse.json()
    mapData = responseData.heatmap_data || []
    mapError = null
  }catch(e){
    mapError = e.message
    mapData = null
    console.error('Map fetch error:', e)
  }
}
return {mapData,mapError};
}});

define({id: "5ffea288", inputs: ["mapError","display","html","mapData","dateSetFile","heatmapOnly","selectPlaceValue"], body: (mapError,display,html,mapData,dateSetFile,heatmapOnly,selectPlaceValue) => {
if(mapError){
  display(html`<div class="card" style="padding: 20px; color: red;">
    <h3>Error loading heatmap</h3>
    <p>${mapError}</p>
  </div>`)
} else if(mapData && mapData.length > 0){
  display(html`
    <div class="card" style="overflow: hidden;">
      <h2>Vehicle Base Heatmap</h2>
      <h3 style="color: #666;">
        Heatmap of missions by selected base locations (${dateSetFile})
      </h3>
      ${heatmapOnly(mapData)}
    </div>
  `)
} else if(selectPlaceValue && selectPlaceValue.length > 0){
  display(html`<div class="card" style="padding: 20px; color: #666;">
    <p>No data available for selected base locations.</p>
  </div>`)
}
}});

define({id: "0ecc838a", outputs: ["timeDiffResponse","response_time"], body: async () => {
const timeDiffResponse = await fetch('http://localhost:5001/api/get_master_response_time')

const response_time = await timeDiffResponse.json() 
return {timeDiffResponse,response_time};
}});

define({id: "0acf42a1", inputs: ["response_time"], outputs: ["responseTimeData"], body: (response_time) => {
const responseTimeData = response_time.data || []
return {responseTimeData};
}});

define({id: "6a81d761", outputs: ["responseTimeChart"], body: async () => {
const {responseTimeChart} = await import("./_import/components/scenario-modeling/responseTimeChart.d77f6cc8.js");

return {responseTimeChart};
}});

define({id: "6dd15198", inputs: ["responseTimeData","display"], body: async (responseTimeData,display) => {
display(await(
responseTimeData
))
}});

define({id: "032b9509", inputs: ["responseTimeChart","responseTimeData","display"], body: async (responseTimeChart,responseTimeData,display) => {
display(await(
responseTimeChart(responseTimeData)
))
}});

</script>
</head>
<body>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Lifeflight Dashboard</a></li>
  </ol>
  <section>
    <summary>Forecasting</summary>
    <ol>
    <li class="observablehq-link"><a href="./demand-forecasting">Demand Forecasting</a></li>
    </ol>
  </section>
  <section class="observablehq-section-active">
    <summary>What-If Scenarios: Coverage Optimization</summary>
    <ol>
    <li class="observablehq-link observablehq-link-active"><a href="./base-analysis">Base analysis</a></li>
    <li class="observablehq-link"><a href="./scenario-modeling">All Units Coverage</a></li>
    <li class="observablehq-link"><a href="./ground-unit">Ground Units Coverage</a></li>
    </ol>
  </section>
</nav>
<script>{const e=document.querySelector("#observablehq-sidebar"),o=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?o.checked=r==="true":o.indeterminate=!0;for(const t of document.querySelectorAll("#observablehq-sidebar summary")){const s=t.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${t.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<div id="observablehq-center">
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type)[id], h2:first-child[id], :not(h1) + h2[id]">
<nav>
<div>Contents</div>
<ol>
<li class="observablehq-secondary-link"><a href="#pickup-location-heatmap">Pickup Location Heatmap</a></li>
<li class="observablehq-secondary-link"><a href="#response-time-analysis-base-patient-location">Response Time Analysis (Base → Patient Location)</a></li>
</ol>
</nav>
</aside>
<main id="observablehq-main" class="observablehq">
<div class="breadcrumb" style="margin-bottom: 2rem; color: #666; font-size: 0.9rem;">
  <a href="./">Home</a> › 
  <span style="color: #333; font-weight: 500;">What-If: Coverage Optimization</span> › 
  <span style="color: #333; font-weight: 500;">2.1 Existing Base Analysis</span>
</div>
<p>In section 2, we analyze the current base coverage and compare the average Travel Time to Scene before and after the changes.</p>
<p>Only missions that occurred in the state of Maine are included (based on tasks where the pickup city is located in Maine).</p>
<h1 id="2-1-current-base-analysis" tabindex="-1"><a class="observablehq-header-anchor" href="#2-1-current-base-analysis">2.1 Current Base Analysis</a></h1>
<br>
<!-- ## Vehicle Mileage Statistics
We use the ‘Roux Full Dispatch Data–redacted–v2’ dataset (2012.07–2023.12).
Each record belongs to one of four air bases:
- L1: Bangor Rotor-Wing
- L2: Lewiston Rotor-Wing
- L3: Bangor Fixed-Wing
- L4: Sanford Rotor-Wing

L3 has a much higher median mileage and wider outliers, consistent with its role as a Fixed-Wing base handling longer-distance missions.

L1 has the most missions and the second-highest median mileage, suggesting it is a larger Rotor-Wing base with broader coverage.

```js
const response = await fetch('http://localhost:5001/api/boxplot')
```

```js
const res = await response.json()
```

```js
const boxplotData = res.data.data
const summary = res.data.summary
```

<div class = 'card' style='width:150px'>

```js
const showOutlier = view(Inputs.toggle({label:'Show outlier',value: true}))
```
</div>

```js
import {boxPlot} from "./components/scenario-modeling/boxPlot.js"
```

```js
boxPlot(boxplotData,showOutlier) 
``` -->
<!-- ```js
html`<div style="margin-top: 20px;">
  <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; margin-top: 15px;">
    ${Object.keys(summary || {}).map(veh => {
      const stats = summary[veh];
      const fieldLabels = {
        count: 'Count',
        min: 'Min',
        q1: 'Q1',
        median: 'Median',
        mean: 'Mean',
        q3: 'Q3',
        max: 'Max',
        std: 'Std Dev'
      };
      
      return html`<div class="card">
        <h4>${veh}</h4>
        <table style="width: 100%; border-collapse: collapse;">
          ${Object.entries(stats).map(([key, value]) => {
            const label = fieldLabels[key] || key;
            const displayValue = key === 'count' 
              ? value 
              : `${value.toFixed(2)} miles`;
            return html`<tr>
              <td style="padding: 4px 8px; color: #666;">${label}:</td>
              <td style="padding: 4px 8px; text-align: right; font-weight: 400;">${displayValue}</td>
            </tr>`;
          })}
        </table>
      </div>`;
    })}
  </div>
</div>`
``` -->
<h2 id="pickup-location-heatmap" tabindex="-1"><a class="observablehq-header-anchor" href="#pickup-location-heatmap">Pickup Location Heatmap</a></h2>
<p>The heatmap displays the PU cities associated with each unit.</p>
<p>Because the two datasets cover different time periods and operational units, the dataset and unit type can be selected by the user.</p>
<p>This visualization highlights the mission coverage area for each base.</p>
<div class="observablehq observablehq--block"><!--:e9491cd9:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:c81f12a3:--></div>
<div class="observablehq observablehq--block"><!--:2f32ee86:--></div>
<div class="observablehq observablehq--block"><!--:cfa06570:--></div>
<div class="observablehq observablehq--block"><!--:542cb9ec:--></div>
<div class="observablehq observablehq--block"><!--:391f33ff:--></div>
<div class="observablehq observablehq--block"><!--:5ffea288:--></div>
<h2 id="response-time-analysis-base-patient-location" tabindex="-1"><a class="observablehq-header-anchor" href="#response-time-analysis-base-patient-location">Response Time Analysis (Base → Patient Location)</a></h2>
<div class="note" label="Data Notes">
<ul>
<li>Only the <em>FlightTransportsMaster.csv(2021-2024)</em> dataset is used, as the <em>Roux Full Dispatch Data-redacted-v2.csv(2012-2023)</em> dataset contains inconsistent date formats that affect cross-day missions.</li>
<li>Response time is calculated as <em>enrtime</em> – <em>atstime</em> (vehicle departure to arrival at patient location).</li>
<li>Only cities with more than 10 missions are included.</li>
</ul>
</div>
<div class="observablehq observablehq--block"><!--:0ecc838a:--></div>
<div class="observablehq observablehq--block"><!--:0acf42a1:--></div>
<div class="observablehq observablehq--block"><!--:6a81d761:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:6dd15198:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:032b9509:--></div>
<p>This chart examines whether certain cities have longer response times because they are farther from a specific base.</p>
<p>Cities show clear preferences for specific bases, indicated by the consistent point colors within each city. The rightmost points on each horizontal line highlight missions with the longest en-route times.</p>
<p>For example, Portland shows several neonatal transports with much longer travel times handled by neoGround, while faster missions were completed by LF3 and LF4. This pattern suggests that neoGround is relatively distant from Portland, indicating potential value in establishing a closer base.</p>
<div class="note" label="Presentation Question">
Previously, we used <span style=" font-size: 0.95rem; padding: 0.15rem 0.4rem; border-radius: 6px; border: 1px solid #d0d7de; background:white;"> Plot.normalizeX </span> to normalize the data. This made the charts look cleaner and helped us compare patterns within each city. But we later found a problem: the normalized values can’t really be compared across different cities, because each city is normalized based on its own total.
<p>For example, if a city has longer response times (like 20–60 minutes), its normalized values might end up smaller. Another city with shorter response times (like 5–15 minutes) might get larger normalized values.
So when we sort by the normalized values, a city with longer actual response times could appear earlier, and a city with shorter times could appear later. That doesn’t really make sense.</p>
<p>So we decided to remove normalization and just use the raw response time (in minutes). This way, the sorting correctly matches the actual response times.</p>
</div></main>
<footer id="observablehq-footer">
<nav><a rel="prev" href="./demand-forecasting"><span>Demand Forecasting</span></a><a rel="next" href="./scenario-modeling"><span>All Units Coverage</span></a></nav>
<div>Built with <a href="https://observablehq.com/" target="_blank" rel="noopener noreferrer">Observable</a> on <a title="2025-12-06T15:37:29">Dec 6, 2025</a>.</div>
</footer>
</div>
</body>
</html>
