<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.13.3">
<title>Service Coverage: Ground Units | Lifeflight Dashboard</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,near-midnight.dcdbf18e.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,near-midnight.dcdbf18e.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="modulepreload" href="./_observablehq/client.33da7c34.js">
<link rel="modulepreload" href="./_observablehq/runtime.e080113b.js">
<link rel="modulepreload" href="./_observablehq/stdlib.73a8ec5a.js">
<link rel="modulepreload" href="./_import/components/scenario-modeling/rangeMap.58863583.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/72f4716c.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.4ef1d259.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/18cbf477.js">
<link rel="icon" href="./_file/observable.1af93621.png" type="image/png" sizes="32x32">
<script type="module">

import {define} from "./_observablehq/client.33da7c34.js";

define({id: "b248d2ca", outputs: ["speedsResponse","speedsData","baseSpeeds"], body: async () => {
const speedsResponse = await fetch('http://localhost:5001/api/get_special_base_speeds')
const speedsData = await speedsResponse.json()
const baseSpeeds = speedsData.speeds || {}
return {speedsResponse,speedsData,baseSpeeds};
}});

define({id: "f614d128", mode: "inline", inputs: ["baseSpeeds","html","display"], body: async (baseSpeeds,html,display) => {
display(await(
Object.entries(baseSpeeds).map(([base, speed]) => {
        return html`<tr>
          <td style="padding: 8px; color: #666;">${base}:</td>
          <td style="padding: 8px; text-align: right; font-weight: 500;">${speed.toFixed(2)} mph</td>
        </tr>`;
      })
))
}});

define({id: "c2805b41", inputs: ["Inputs"], outputs: ["centerType"], body: (Inputs) => {
const centerType = Inputs.radio(['neoGround', 'L-CCT', 'B-CCT', 'S-CCT'], {
  label: "Select Center Type",
  value: 'neoGround'
})
return {centerType};
}});

define({id: "7aaf6c68", inputs: ["centerType","display"], body: async (centerType,display) => {
display(await(
centerType
))
}});

define({id: "e6247b4e", inputs: ["Generators","centerType"], outputs: ["selectedCenterType"], body: (Generators,centerType) => {
const selectedCenterType = Generators.input(centerType)
return {selectedCenterType};
}});

define({id: "f8e67790", inputs: ["Inputs"], outputs: ["specialBaseRadius","specialBaseExpectedTime"], body: (Inputs) => {
const specialBaseRadius = Inputs.range([20, 300], {label: "Service Radius (miles)", value: 50, step: 1})
const specialBaseExpectedTime = Inputs.range([10, 50], {label: "Expected Dispatch-to-Patient Time (Minutes)", value: 20, step: 1})
return {specialBaseRadius,specialBaseExpectedTime};
}});

define({id: "75d8e7e3", inputs: ["html","specialBaseRadius","specialBaseExpectedTime","display"], body: async (html,specialBaseRadius,specialBaseExpectedTime,display) => {
display(await(
html.fragment`${specialBaseRadius}
${specialBaseExpectedTime}`
))
}});

define({id: "9de6f7cd", inputs: ["Generators","specialBaseRadius","specialBaseExpectedTime"], outputs: ["specialBaseRadiusValue","specialBaseExpectedTimeValue"], body: (Generators,specialBaseRadius,specialBaseExpectedTime) => {
const specialBaseRadiusValue = Generators.input(specialBaseRadius)
const specialBaseExpectedTimeValue = Generators.input(specialBaseExpectedTime)
return {specialBaseRadiusValue,specialBaseExpectedTimeValue};
}});

define({id: "c9ec7730", outputs: ["citiesResponse","citiesData","maineCities","maineCitiesSet"], body: async () => {
const citiesResponse = await fetch('http://localhost:5001/api/get_maine_cities')
const citiesData = await citiesResponse.json()
const maineCities = citiesData.cities || []
const maineCitiesSet = new Set(maineCities.map(c => c.toUpperCase().trim()))
return {citiesResponse,citiesData,maineCities,maineCitiesSet};
}});

define({id: "14d75502", inputs: ["selectedCenterType","URLSearchParams"], outputs: ["initialBaseCity"], body: async (selectedCenterType,URLSearchParams) => {
let initialBaseCity = null
if(selectedCenterType){
  try{
    const tempParams = new URLSearchParams({
      centerType: selectedCenterType,
      radius: 50,
      expectedTime: 20
    })
    const tempResponse = await fetch(`http://localhost:5001/api/get_special_base_statistics?${tempParams}`)
    if(tempResponse.ok){
      const tempData = await tempResponse.json()
     // get base city
      const coverageStats = tempData.statistics?.coverage_stats || {}
      initialBaseCity = Object.keys(coverageStats)[0] || null
    }
  }catch(e){
    console.error('Error getting initial base city:', e)
  }
}

return {initialBaseCity};
}});

define({id: "99804e5e", inputs: ["Inputs","initialBaseCity"], outputs: ["cityTextarea"], body: (Inputs,initialBaseCity) => {
const cityTextarea = Inputs.textarea({
  label: "Base Cities (comma-separated)",
  placeholder: "Enter city names separated by commas (e.g., PORTLAND, BANGOR)",
  value: initialBaseCity || "",
  rows: 4,
  submit: true
})
return {cityTextarea};
}});

define({id: "e79ed7a7", inputs: ["cityTextarea","display"], body: async (cityTextarea,display) => {
display(await(
cityTextarea
))
}});

define({id: "104c7113", inputs: ["Generators","cityTextarea"], outputs: ["cityTextareaValue"], body: (Generators,cityTextarea) => {
const cityTextareaValue = Generators.input(cityTextarea)
return {cityTextareaValue};
}});

define({id: "528665c4", outputs: ["rangeMap"], body: async () => {
const {rangeMap} = await import("./_import/components/scenario-modeling/rangeMap.58863583.js");

return {rangeMap};
}});

define({id: "75e314f7", inputs: ["selectedCenterType","URLSearchParams","specialBaseRadiusValue","specialBaseExpectedTimeValue","cityTextareaValue"], outputs: ["specialBaseMapData","specialBaseStats","specialBaseError"], body: async (selectedCenterType,URLSearchParams,specialBaseRadiusValue,specialBaseExpectedTimeValue,cityTextareaValue) => {
let specialBaseMapData = null
let specialBaseStats = null
let specialBaseError = null

if(selectedCenterType){
  try{
    const params = new URLSearchParams({
      centerType: selectedCenterType,
      radius: specialBaseRadiusValue,
      expectedTime: specialBaseExpectedTimeValue
    })
    
    if(cityTextareaValue && typeof cityTextareaValue === 'string' && cityTextareaValue.trim()){
      params.append('baseCities', cityTextareaValue)
    }
    
    const specialBaseResponse = await fetch(`http://localhost:5001/api/get_special_base_statistics?${params}`)
    if(!specialBaseResponse.ok){
      throw new Error(`HTTP ${specialBaseResponse.status}: ${specialBaseResponse.statusText}`)
    }
    const responseData = await specialBaseResponse.json()
    specialBaseMapData = {
      heatmapData: responseData.heatmap_data || [],
      baseLocations: responseData.base_locations || []
    }
    specialBaseStats = responseData.statistics
    specialBaseError = null
  }catch(e){
    specialBaseError = e.message
    specialBaseMapData = null
    specialBaseStats = null
    console.error('Special base fetch error:', e)
  }
}
return {specialBaseMapData,specialBaseStats,specialBaseError};
}});

define({id: "180bdce8", mode: "inline", inputs: ["selectedCenterType","display"], body: async (selectedCenterType,display) => {
display(await(
selectedCenterType
))
}});

define({id: "15cf449a", inputs: ["specialBaseError","display","html","specialBaseMapData","selectedCenterType","specialBaseRadiusValue","cityTextareaValue","rangeMap"], body: (specialBaseError,display,html,specialBaseMapData,selectedCenterType,specialBaseRadiusValue,cityTextareaValue,rangeMap) => {
if(specialBaseError){
  display(html`<div class="card" style="padding: 20px; color: red;">
    <h3>Error loading Ground Unit map</h3>
    <p>${specialBaseError}</p>
  </div>`)
} else if(specialBaseMapData){
  display(html`
    <div class="card" style="overflow: hidden;">
      <h2>Ground Unit Range Map - ${selectedCenterType}</h2>
      <h3 style="color: #666;">
        Service coverage with ${specialBaseRadiusValue} mile radius
        ${cityTextareaValue && cityTextareaValue.trim() ? `(Base Cities: ${cityTextareaValue})` : ''}
      </h3>
      ${rangeMap(specialBaseMapData.heatmapData, specialBaseMapData.baseLocations, specialBaseRadiusValue)}
    </div>
  `)
} else if(!selectedCenterType){
  display(html`<div class="card" style="padding: 20px; color: #666;">
    <p>Please select a center type to view the map.</p>
  </div>`)
}
}});

define({id: "af2fcbbe", inputs: ["specialBaseStats","display","html"], body: (specialBaseStats,display,html) => {
if(specialBaseStats){
  display(html`<div style="margin-top: 20px;">   
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 15px;">
      ${Object.entries(specialBaseStats.coverage_stats || {}).map(([base, count]) => {
        return html`<div class="card">
          <h4>${base}</h4>
          <p style="font-size: 18px; font-weight: bold; color: #2E86C1; margin: 10px 0;">
            ${count} cities covered
          </p>
        </div>`;
      })}
    </div>
    
    
  </div>`)
}
}});

define({id: "faa20e25", mode: "inline", inputs: ["specialBaseStats","display"], body: async (specialBaseStats,display) => {
display(await(
specialBaseStats.compliance_stats?.total_tasks || 0
))
}});

define({id: "28aa30f2", mode: "inline", inputs: ["specialBaseStats","display"], body: async (specialBaseStats,display) => {
display(await(
specialBaseStats.compliance_stats?.compliant_tasks || 0
))
}});

define({id: "5bc43f46", mode: "inline", inputs: ["specialBaseStats","display"], body: async (specialBaseStats,display) => {
display(await(
specialBaseStats.compliance_stats?.compliance_rate?.toFixed(2) || 0
))
}});

define({id: "5b67a15b", mode: "inline", inputs: ["specialBaseStats","display"], body: async (specialBaseStats,display) => {
display(await(
specialBaseStats.compliance_stats?.avg_response_time?.toFixed(2) || 0
))
}});

</script>
</head>
<body>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Lifeflight Dashboard</a></li>
  </ol>
  <section>
    <summary>Forecasting</summary>
    <ol>
    <li class="observablehq-link"><a href="./demand-forecasting">Demand Forecasting</a></li>
    </ol>
  </section>
  <section class="observablehq-section-active">
    <summary>What-If Scenarios: Coverage Optimization</summary>
    <ol>
    <li class="observablehq-link"><a href="./base-analysis">Base analysis</a></li>
    <li class="observablehq-link"><a href="./scenario-modeling">All Units Coverage</a></li>
    <li class="observablehq-link observablehq-link-active"><a href="./ground-unit">Ground Units Coverage</a></li>
    </ol>
  </section>
</nav>
<script>{const e=document.querySelector("#observablehq-sidebar"),o=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?o.checked=r==="true":o.indeterminate=!0;for(const t of document.querySelectorAll("#observablehq-sidebar summary")){const s=t.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${t.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<div id="observablehq-center">
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type)[id], h2:first-child[id], :not(h1) + h2[id]">
<nav>
<div>Contents</div>
<ol>
<li class="observablehq-secondary-link"><a href="#speed-analysis">Speed Analysis</a></li>
<li class="observablehq-secondary-link"><a href="#select-ground-unit-type">Select Ground Unit Type</a></li>
<li class="observablehq-secondary-link"><a href="#ground-unit-statistics">Ground Unit Statistics - </a></li>
</ol>
</nav>
</aside>
<main id="observablehq-main" class="observablehq">
<div class="breadcrumb" style="margin-bottom: 2rem; color: #666; font-size: 0.9rem;">
  <a href="./">Home</a> › 
  <span style="color: #333; font-weight: 500;">What-If: Coverage Optimization</span> › 
  <span style="color: #333; font-weight: 500;">2.3 Service Coverage: Ground Units</span>
</div>
<h1 id="2-3-service-coverage-ground-units" tabindex="-1"><a class="observablehq-header-anchor" href="#2-3-service-coverage-ground-units">2.3 Service Coverage: Ground Units</a></h1>
<div class="note" label="Data Notes">
<ul>
<li>This analysis uses the <em>FlightTransportsMaster.csv(2021-2024)</em> as it involves time-based calculations.</li>
<li>Ground units’ missions are highly concentrated near their bases. Longer missions, especially for neoGround, result in significantly increased response times. This makes the base location of Ground Units more critical than Air Units, warranting a separate analysis.</li>
<li>Ground Units included: B-CCT, L-CCT, S-CCT, neoGround.(B-CCT, L-CCT, and S-CCT are the same type of unit but at different locations. However, considering possible differences in base configuration, they are treated as separate types here.)</li>
</ul>
</div>
<h2 id="speed-analysis" tabindex="-1"><a class="observablehq-header-anchor" href="#speed-analysis">Speed Analysis</a></h2>
<p>Median speed is calculated for each base to estimate the typical mission speed from base to patient location.</p>
<div class="observablehq observablehq--block"><!--:b248d2ca:--></div>
<div class="grid" style="grid-template-columns: 1fr 2fr;">
<div class="card" style="margin-top:20px;height: 70%;">
    <h3>Ground Unit Speed Statistics</h3>
    <table style="width: 100%; border-collapse: collapse;">
      <!--:f614d128:-->
    </table>
  </div>
<div class="note" label="Calculation Notes">
<ul>
<li>Speed for each unit is estimated using the median speed of its past missions.</li>
<li>Distance between cities is calculated from city coordinates.</li>
<li>Service time for each mission is computed as distance ÷ speed.</li>
</ul>
</div>
</div>
<h2 id="select-ground-unit-type" tabindex="-1"><a class="observablehq-header-anchor" href="#select-ground-unit-type">Select Ground Unit Type</a></h2>
<p>Choose the Ground Unit type to analyze.</p>
<div class="observablehq observablehq--block"><!--:c2805b41:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:7aaf6c68:--></div>
<div class="observablehq observablehq--block"><!--:e6247b4e:--></div>
<div class="observablehq observablehq--block"><!--:f8e67790:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:75d8e7e3:--></div>
<div class="observablehq observablehq--block"><!--:9de6f7cd:--></div>
<div class="observablehq observablehq--block"><!--:c9ec7730:--></div>
<div class="observablehq observablehq--block"><!--:14d75502:--></div>
<div class="observablehq observablehq--block"><!--:99804e5e:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:e79ed7a7:--></div>
<div class="observablehq observablehq--block"><!--:104c7113:--></div>
<div class="observablehq observablehq--block"><!--:528665c4:--></div>
<div class="observablehq observablehq--block"><!--:75e314f7:--></div>
<h2 id="ground-unit-statistics" tabindex="-1"><a class="observablehq-header-anchor" href="#ground-unit-statistics">Ground Unit Statistics - <observablehq-loading></observablehq-loading><!--:180bdce8:--></a></h2>
<div class="observablehq observablehq--block"><!--:15cf449a:--></div>
<div class="observablehq observablehq--block"><!--:af2fcbbe:--></div>
<!-- <div class="note" label="Metrics">

- Cities Covered: Number of cities within the unit’s service range.
- Compliance Statistics: Compares the total number of missions in coverage with the number of missions meeting response-time standards.
</div> -->
<div class="grid" style="grid-template-columns: 1fr 2fr;">
<div class="card" style="height: 70%;margin-top:15px">
      <h4>Compliance Statistics</h4>
      <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
        <tbody><tr>
          <td style="padding: 8px; color: #666;">Total Tasks:</td>
          <td style="padding: 8px; text-align: right; font-weight: 500;"><observablehq-loading></observablehq-loading><!--:faa20e25:--></td>
        </tr>
        <tr>
          <td style="padding: 8px; color: #666;">Compliant Tasks:</td>
          <td style="padding: 8px; text-align: right; font-weight: 500; color: #28B463;"><observablehq-loading></observablehq-loading><!--:28aa30f2:--></td>
        </tr>
        <tr>
          <td style="padding: 8px; color: #666;">Compliance Rate:</td>
          <td style="padding: 8px; text-align: right; font-weight: 500; color: #28B463;"><observablehq-loading></observablehq-loading><!--:5bc43f46:-->%</td>
        </tr>
        <tr>
          <td style="padding: 8px; color: #666;">Avg Response Time:</td>
          <td style="padding: 8px; text-align: right; font-weight: 500;"><observablehq-loading></observablehq-loading><!--:5b67a15b:--> minutes</td>
        </tr>
      </tbody></table>
    </div>
<div class="note" label="Calculation Notes">
<ul>
<li>Adding a new base recalculates service coverage and arrival times.</li>
<li>If coverage areas overlap, the shorter arrival time is used.</li>
</ul>
</div>
<div>
</div></div></main>
<footer id="observablehq-footer">
<nav><a rel="prev" href="./scenario-modeling"><span>All Units Coverage</span></a></nav>
<div>Built with <a href="https://observablehq.com/" target="_blank" rel="noopener noreferrer">Observable</a> on <a title="2025-12-06T15:37:29">Dec 6, 2025</a>.</div>
</footer>
</div>
</body>
</html>
